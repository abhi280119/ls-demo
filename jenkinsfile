pipeline {
	agent any
	
	tools {
  		maven 'M2_HOME'
	}
	
	//triggers {
  	//	pollSCM '* * * * *'
	//}

	stages {
		stage('Code Checkout') {
			steps {
				echo '++++++++++++++++++++Code Checkout stage - checking out the source code++++++++++++++++++++'
				git 'https://github.com/abhi280119/ls-demo'
				echo '++++++++++++++++++++Code Checkout stage - checking out the source code++++++++++++++++++++'
			}
		}
		
		stage('Clean') {
			steps {
				echo '++++++++++++++++++++Clean stage - clearing last build files++++++++++++++++++++'
				sh "mvn clean"
				echo '++++++++++++++++++++Clean stage - last build files have been deleted++++++++++++++++++++'
			}
		}
		
		stage('Unit Test, Compile & Build') {
			steps {
				echo '++++++++++++++++++++Build stage - compiling and building artifact++++++++++++++++++++'
				sh "mvn package"
				echo '++++++++++++++++++++Build stage - build successfully generated++++++++++++++++++++'
			}
		}
		
		stage('Deploy') {
			steps {
				echo '++++++++++++++++++++Deploy stage - deploying artifact++++++++++++++++++++'
				deploy adapters: [tomcat9(credentialsId: 'deployer_user', path: '', url: 'http://34.243.111.63:8080/')], contextPath: null, war: '**/*.war'
				echo '++++++++++++++++++++Deploy stage - artifact deployed++++++++++++++++++++'
			}
		}
	}
}
